{% extends '::base.html.twig' %}

{% block body %}

<div class="page-header">
    <h1>Usuário
      <small>Cadastro de novo usuário</small></h1>
</div>

<div class="well">

	<form action="{{ path(app.request.attributes.get('_route'), app.request.attributes.get('_route_params')) }}" method="post" {{ form_enctype(form) }}>

		{{ form_widget(form) }}
		{{ form_rest(form) }}

		<div class="form-opcoes">
			<input type="reset" value="Limpar Valores" class="btn btn-small" />
			<input type="submit" value="Salvar Dados" class="btn btn-primary btn-small" />
		</div>

	</form>
</div>

<div>
	<a class="btn btn-danger btn-small"  href="{{ path('cacic_usuario_index') }}">Cancelar</a>
</div>

<script type="text/javascript">
	
	var oLocais = []; // JSON com Locais

	/**
	 * Monta JSON com lista de Locais
	 */
	$(document).ready(function(){
		$( '#usuario_idLocal option' ).each(function(){
			if ( $(this).val() != '' && $(this).val() != undefined )
			{
				oLocais.push({ idLocal: $(this).val(), nmLocal: $(this).text() });
			}
		})
	});

	/**
	 * Remove o local principal selecionado da lista de locais secundários
	 */
	$( '#usuario_idLocal' ).change(function(){
		// Primeiro, remove todos os itens da combo de locais secundários
		$( '#usuario_TeLocaisSecundarios option' ).each(function(){
			$(this).remove();
		});
		
		// Preenche novamente o select de locais secundários, omitindo o elemento selecionado no combo de Local Principal
		for ( var i in oLocais )
		{
			if ( oLocais[i].idLocal != $(this).val() )
			{
				var sOption = '<option value="'+ oLocais[i].idLocal +'">'+ oLocais[i].nmLocal +'</option>';
				$( '#usuario_TeLocaisSecundarios' ).append( sOption );
			}
		}
	});
	
</script>
{% endblock %}